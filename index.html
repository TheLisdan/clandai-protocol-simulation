<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CLNDAI AMM Simulation</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <div class="pool-stats">
          <div class="stat price-highlight">
            <span class="label">Цена CLNDAI</span>
            <span class="value" id="currentPrice">0.1000</span>
          </div>
          <div class="stat">
            <span class="label">DAI в пуле</span>
            <span class="value" id="poolDai">10000</span>
          </div>
          <div class="stat">
            <span class="label">CLNDAI в пуле</span>
            <span class="value" id="poolClndai">100000</span>
          </div>
          <div class="stat">
            <span class="label">k</span>
            <span class="value" id="constantK">1000000000</span>
          </div>
          <div class="stat">
            <span class="label">День</span>
            <span class="value" id="currentDay">0</span>
          </div>
        </div>
      </header>

      <section class="settings">
        <div class="settings-row">
          <label
            >Комиссия покупки %<input
              type="number"
              id="buyFee"
              value="0.3"
              min="0"
              max="10"
              step="0.1"
          /></label>
          <label
            >Комиссия продажи %<input
              type="number"
              id="sellFee"
              value="0.3"
              min="0"
              max="10"
              step="0.1"
          /></label>
          <label
            >DAI в пуле<input
              type="number"
              id="initDai"
              value="10000"
              min="100"
          /></label>
          <label
            >CLNDAI в пуле<input
              type="number"
              id="initClndai"
              value="100000"
              min="100"
          /></label>
          <button id="resetPool">Сброс пула</button>
        </div>
      </section>

      <section class="controls">
        <div class="control-row">
          <button id="stepDay">+1 День</button>
          <button id="step7Days">+7 Дней</button>
          <button id="step30Days">+30 Дней</button>
          <button id="resetAll">Сбросить всё</button>
        </div>
        <div class="add-player-row">
          <input type="text" id="playerName" placeholder="Имя" />
          <input
            type="number"
            id="playerDai"
            placeholder="Баланс DAI"
            value="1000"
          />
          <select id="playerStrategy">
            <option value="passive">Пассивный (редко)</option>
            <option value="moderate">Умеренный</option>
            <option value="active">Активный (часто)</option>
            <option value="whale">Кит (большие объёмы)</option>
          </select>
          <button id="addPlayer">+ Игрок</button>
        </div>
      </section>

      <section class="players">
        <h2>Игроки</h2>
        <p class="note">
          <strong>P/L (один)</strong> — если только этот игрок продаст свои
          CLNDAI.<br />
          <strong>P/L (все)</strong> — если ВСЕ игроки одновременно продадут
          (реалистичный сценарий).<br />
          <em
            >Когда все продают — цена обваливается и все получают меньше. Это и
            есть реальность.</em
          >
        </p>
        <table id="playersTable">
          <thead>
            <tr>
              <th>Имя</th>
              <th>DAI</th>
              <th>CLNDAI</th>
              <th>Потратил</th>
              <th>Получил</th>
              <th>P/L (один)</th>
              <th>P/L (все)</th>
              <th>Действия</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <section class="trades">
        <h2>История сделок</h2>
        <table id="tradesTable">
          <thead>
            <tr>
              <th>День</th>
              <th>Игрок</th>
              <th>Тип</th>
              <th>Сумма</th>
              <th>Получил</th>
              <th>Цена</th>
              <th>Комиссия</th>
              <th>DAI пула</th>
              <th>CLNDAI пула</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <section class="pl-history">
        <h2>P/L по дням (DAI)</h2>
        <div class="table-scroll">
          <table id="plHistoryTable">
            <thead>
              <tr>
                <th>Игрок</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="summary">
        <h2>Итоги</h2>
        <p class="note">
          <strong>Сумма P/L всех игроков должна быть отрицательной</strong> -
          AMM это игра с нулевой суммой минус комиссии.<br />
          Если кто-то в плюсе, значит кто-то другой в минусе. Плюс slippage при
          продаже больших объёмов.
        </p>
        <div class="stats-grid">
          <div class="stat-card">
            <span class="label">Сумма P/L всех</span>
            <span class="value" id="totalPL">0</span>
          </div>
          <div class="stat-card">
            <span class="label">Всего комиссий</span>
            <span class="value" id="totalFees">0</span>
          </div>
          <div class="stat-card">
            <span class="label">Всего сделок</span>
            <span class="value" id="totalTrades">0</span>
          </div>
          <div class="stat-card">
            <span class="label">Объём торгов DAI</span>
            <span class="value" id="totalVolume">0</span>
          </div>
        </div>
      </section>
    </div>

    <script src="simulation.js"></script>
  </body>
</html>
